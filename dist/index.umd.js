!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.CallApp=t()}(this,function(){"use strict";function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function t(e,t){return e(t={exports:{}},t.exports),t.exports}var s,n,r,o=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e},i={}.hasOwnProperty,v=function(e,t){return i.call(e,t)},u={}.toString,a=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==(t=e,u.call(t).slice(8,-1))?e.split(""):Object(e);var t},l=function(e){return a(o(e))},c=Math.ceil,f=Math.floor,p=function(e){return isNaN(e=+e)?0:(0<e?f:c)(e)},d=Math.min,h=Math.max,y=Math.min,m=t(function(e){var t=e.exports={version:"2.5.7"};"number"==typeof __e&&(__e=t)}),b=(m.version,t(function(e){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)})),g=t(function(e){var t="__core-js_shared__",n=b[t]||(b[t]={});(e.exports=function(e,t){return n[e]||(n[e]=void 0!==t?t:{})})("versions",[]).push({version:m.version,mode:"pure",copyright:"Â© 2018 Denis Pushkarev (zloirock.ru)"})}),w=0,_=Math.random(),O=g("keys"),k=(s=!1,function(e,t,n){var r,o,i,u,a=l(e),c=0<(r=a.length)?d(p(r),9007199254740991):0,f=(i=c,(o=p(o=n))<0?h(o+i,0):y(o,i));if(s&&t!=t){for(;f<c;)if((u=a[f++])!=u)return!0}else for(;f<c;f++)if((s||f in a)&&a[f]===t)return s||f||0;return!s&&-1}),S=O[n="IE_PROTO"]||(O[n]="Symbol(".concat(void 0===(r=n)?"":r,")_",(++w+_).toString(36))),j="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),C=Object.keys||function(e){return function(e,t){var n,r=l(e),o=0,i=[];for(n in r)n!=S&&v(r,n)&&i.push(n);for(;t.length>o;)v(r,n=t[o++])&&(~k(i,n)||i.push(n));return i}(e,j)},E=function(r,o,e){if(function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!")}(r),void 0===o)return r;switch(e){case 1:return function(e){return r.call(o,e)};case 2:return function(e,t){return r.call(o,e,t)};case 3:return function(e,t,n){return r.call(o,e,t,n)}}return function(){return r.apply(o,arguments)}},M=function(e){return"object"==typeof e?null!==e:"function"==typeof e},x=function(e){if(!M(e))throw TypeError(e+" is not an object!");return e},T=function(e){try{return!!e()}catch(e){return!0}},P=!T(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),I=b.document,F=M(I)&&M(I.createElement),U=!P&&!T(function(){return 7!=Object.defineProperty((e="div",F?I.createElement(e):{}),"a",{get:function(){return 7}}).a;var e}),A=Object.defineProperty,z={f:P?Object.defineProperty:function(e,t,n){if(x(e),t=function(e,t){if(!M(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!M(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!M(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!M(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")}(t,!0),x(n),U)try{return A(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},R=P?function(e,t,n){return z.f(e,t,{enumerable:!((r=1)&r),configurable:!(2&r),writable:!(4&r),value:n});var r}:function(e,t,n){return e[t]=n,e},W="prototype",B=function(e,t,n){var r,o,i,u=e&B.F,a=e&B.G,c=e&B.S,f=e&B.P,s=e&B.B,l=e&B.W,p=a?m:m[t]||(m[t]={}),d=p[W],h=a?b:c?b[t]:(b[t]||{})[W];for(r in a&&(n=t),n)(o=!u&&h&&void 0!==h[r])&&v(p,r)||(i=o?h[r]:n[r],p[r]=a&&"function"!=typeof h[r]?n[r]:s&&o?E(i,b):l&&h[r]==i?function(r){var e=function(e,t,n){if(this instanceof r){switch(arguments.length){case 0:return new r;case 1:return new r(e);case 2:return new r(e,t)}return new r(e,t,n)}return r.apply(this,arguments)};return e[W]=r[W],e}(i):f&&"function"==typeof i?E(Function.call,i):i,f&&((p.virtual||(p.virtual={}))[r]=i,e&B.R&&d&&!d[r]&&R(d,r,i)))};B.F=1,B.G=2,B.S=4,B.P=8,B.B=16,B.W=32,B.U=64,B.R=128;var q,L,Y,Q,G=B;q="keys",L=function(){return function(e){return C(Object(o(e)))}},Y=(m.Object||{})[q]||Object[q],(Q={})[q]=L(Y),G(G.S+G.F*T(function(){Y(1)}),"Object",Q);var H=m.Object.keys,N=e(t(function(e){e.exports={default:H,__esModule:!0}})),V=e(t(function(e,t){t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}}));G(G.S+G.F*!P,"Object",{defineProperty:z.f});var D=m.Object,K=function(e,t,n){return D.defineProperty(e,t,n)},$=t(function(e){e.exports={default:K,__esModule:!0}});e($);var J=e(t(function(e,t){t.__esModule=!0;var n,o=(n=$)&&n.__esModule?n:{default:n};t.default=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),(0,o.default)(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}()}));var X=null;function Z(e){var t,n=document.createElement("a"),r=(t=void 0,window.CustomEvent?t=new window.CustomEvent("click",{canBubble:!0,cancelable:!0}):(t=document.createEvent("HTMLEvents")).initEvent("click",!1,!1),t);n.setAttribute("href",e),n.style.display="none",document.body.appendChild(n),n.dispatchEvent(r)}function ee(e){window.top.location.href=e}function te(e){X||((X=document.createElement("iframe")).frameborder="0",X.style.cssText="display:none;border:0;width:0;height:0;",document.body.appendChild(X)),X.src=e}function ne(e){setTimeout(function(){document.hidden||document.webkitHidden||e()},2500)}return function(){function d(e){V(this,d),this.options=e||{}}return J(d,[{key:"buildScheme",value:function(e){var t=e.path,n=e.param,r=void 0!==n?N(n).map(function(e){return e+"="+n[e]}).join("&"):"";return this.options.protocol+"://"+t+"?"+r}},{key:"generateScheme",value:function(e){var t=this.options.outChain,n=this.buildScheme(e);void 0!==t&&t&&(n=t.protocal+"://"+t.path+"?"+t.key+"="+encodeURIComponent(n));return n}},{key:"generateIntent",value:function(e){var t=e.outChain,n=this.options,r=n.intent,o=n.fallback,i=N(r).map(function(e){return e+"="+r[e]+";"}).join(""),u=this.buildScheme(e);if(void 0!==t&&!t){var a=e.outChain;return"intent://"+a.path+"?"+a.key+"="+encodeURIComponent(u)+"/\n        #Intent;"+i+";S.browser_fallback_url="+o+";end;"}return"intent://"+(u=u.slice(u.indexOf("//")+2))+"/#Intent;"+i+";end;"}},{key:"generateUniversalLink",value:function(e){var t=this.options.universal,n=t.host,r=t.pathKey,o=e.path,i=e.param,u=void 0!==i?N(i).map(function(e){return e+"="+i[e]}).join("&"):"";return"//"+n+"?"+r+"="+o+(u?"&":"")+u}},{key:"generateYingYongBao",value:function(e){var t=this.generateScheme(e);return this.options.yingyongbao+"&android_schema="+encodeURIComponent(t)}},{key:"fallToAppStore",value:function(){var e=this;ne(function(){ee(e.options.appstore)})}},{key:"fallToFbUrl",value:function(){var e=this;ne(function(){ee(e.options.fallback)})}},{key:"open",value:function(e){var t,n,r,o,i=(t=window.navigator.userAgent||"",n=/android/i.test(t),r=/iphone|ipad|ipod/i.test(t),{isAndroid:n,isIos:r,isWechat:/micromessenger\/([\d.]+)/i.test(t),isWeibo:/(weibo).*weibo__([\d.]+)/i.test(t),isQQ:/qq\/([\d.]+)/i.test(t),isQzone:/qzone\/.*_qz_([\d.]+)/i.test(t),isOriginalChrome:/chrome\/[\d.]+ Mobile Safari\/[\d.]+/i.test(t)&&n&&t.indexOf("Version")<0,isSafari:/safari\/([\d.]+)$/i.test(t)&&r&&t.indexOf("Crios")<0&&0===t.indexOf("Mozilla")}),u=this.options,a=u.universal,c=u.appstore,f=u.logFunc,s=e.callback,l=void 0!==a,p=null;void 0!==f&&f(),i.isIos?i.isWechat?ee(c):(o=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),parseInt(o[1],10)<9?(te(this.generateScheme(e)),p=this.fallToAppStore):ee(l?this.generateUniversalLink(e):this.generateScheme(e))):i.isWechat?ee(this.generateYingYongBao(e)):i.isOriginalChrome?Z(this.generateIntent(e)):(te(this.generateScheme(e)),p=this.fallToFbUrl),void 0===s?p&&p.call(this):d.fallToCustomCb(s)}}],[{key:"fallToCustomCb",value:function(e){ne(function(){e()})}}]),d}()});
