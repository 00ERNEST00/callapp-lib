!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):n.CallApp=e()}(this,function(){"use strict";function n(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function e(n,e){return n(e={exports:{}},e.exports),e.exports}var t=n(e(function(n,e){e.__esModule=!0,e.default=function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}})),v=e(function(n){var e=n.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)}),y=e(function(n){var e=n.exports={version:"2.5.7"};"number"==typeof __e&&(__e=e)}),m=(y.version,function(r,o,n){if(function(n){if("function"!=typeof n)throw TypeError(n+" is not a function!")}(r),void 0===o)return r;switch(n){case 1:return function(n){return r.call(o,n)};case 2:return function(n,e){return r.call(o,n,e)};case 3:return function(n,e,t){return r.call(o,n,e,t)}}return function(){return r.apply(o,arguments)}}),o=function(n){return"object"==typeof n?null!==n:"function"==typeof n},r=function(n){if(!o(n))throw TypeError(n+" is not an object!");return n},i=function(n){try{return!!n()}catch(n){return!0}},u=!i(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),a=v.document,c=o(a)&&o(a.createElement),f=!u&&!i(function(){return 7!=Object.defineProperty((n="div",c?a.createElement(n):{}),"a",{get:function(){return 7}}).a;var n}),s=Object.defineProperty,l={f:u?Object.defineProperty:function(n,e,t){if(r(n),e=function(n,e){if(!o(n))return n;var t,r;if(e&&"function"==typeof(t=n.toString)&&!o(r=t.call(n)))return r;if("function"==typeof(t=n.valueOf)&&!o(r=t.call(n)))return r;if(!e&&"function"==typeof(t=n.toString)&&!o(r=t.call(n)))return r;throw TypeError("Can't convert object to primitive value")}(e,!0),r(t),f)try{return s(n,e,t)}catch(n){}if("get"in t||"set"in t)throw TypeError("Accessors not supported!");return"value"in t&&(n[e]=t.value),n}},b=u?function(n,e,t){return l.f(n,e,{enumerable:!((r=1)&r),configurable:!(2&r),writable:!(4&r),value:t});var r}:function(n,e,t){return n[e]=t,n},p={}.hasOwnProperty,g=function(n,e){return p.call(n,e)},w="prototype",_=function(n,e,t){var r,o,i,u=n&_.F,a=n&_.G,c=n&_.S,f=n&_.P,s=n&_.B,l=n&_.W,p=a?y:y[e]||(y[e]={}),d=p[w],h=a?v:c?v[e]:(v[e]||{})[w];for(r in a&&(t=e),t)(o=!u&&h&&void 0!==h[r])&&g(p,r)||(i=o?h[r]:t[r],p[r]=a&&"function"!=typeof h[r]?t[r]:s&&o?m(i,v):l&&h[r]==i?function(r){var n=function(n,e,t){if(this instanceof r){switch(arguments.length){case 0:return new r;case 1:return new r(n);case 2:return new r(n,e)}return new r(n,e,t)}return r.apply(this,arguments)};return n[w]=r[w],n}(i):f&&"function"==typeof i?m(Function.call,i):i,f&&((p.virtual||(p.virtual={}))[r]=i,n&_.R&&d&&!d[r]&&b(d,r,i)))};_.F=1,_.G=2,_.S=4,_.P=8,_.B=16,_.W=32,_.U=64,_.R=128;var d=_;d(d.S+d.F*!u,"Object",{defineProperty:l.f});var h=y.Object,O=function(n,e,t){return h.defineProperty(n,e,t)},k=e(function(n){n.exports={default:O,__esModule:!0}});n(k);var j=n(e(function(n,e){e.__esModule=!0;var t,o=(t=k)&&t.__esModule?t:{default:t};e.default=function(){function r(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),(0,o.default)(n,r.key,r)}}return function(n,e,t){return e&&r(n.prototype,e),t&&r(n,t),n}}()}));var C,S,E,M,T,x,I,P=function(n){if(null==n)throw TypeError("Can't call method on  "+n);return n},F={}.toString,U=Object("z").propertyIsEnumerable(0)?Object:function(n){return"String"==(e=n,F.call(e).slice(8,-1))?n.split(""):Object(n);var e},A=function(n){return U(P(n))},R=Math.ceil,z=Math.floor,W=function(n){return isNaN(n=+n)?0:(0<n?z:R)(n)},B=Math.min,q=Math.max,L=Math.min,Y=e(function(n){var e="__core-js_shared__",t=v[e]||(v[e]={});(n.exports=function(n,e){return t[n]||(t[n]=void 0!==e?e:{})})("versions",[]).push({version:y.version,mode:"pure",copyright:"Â© 2018 Denis Pushkarev (zloirock.ru)"})}),Q=0,G=Math.random(),H=Y("keys"),N=(C=!1,function(n,e,t){var r,o,i,u,a=A(n),c=0<(r=a.length)?B(W(r),9007199254740991):0,f=(i=c,(o=W(o=t))<0?q(o+i,0):L(o,i));if(C&&e!=e){for(;f<c;)if((u=a[f++])!=u)return!0}else for(;f<c;f++)if((C||f in a)&&a[f]===e)return C||f||0;return!C&&-1}),V=H[S="IE_PROTO"]||(H[S]="Symbol(".concat(void 0===(E=S)?"":E,")_",(++Q+G).toString(36))),D="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),K=Object.keys||function(n){return function(n,e){var t,r=A(n),o=0,i=[];for(t in r)t!=V&&g(r,t)&&i.push(t);for(;e.length>o;)g(r,t=e[o++])&&(~N(i,t)||i.push(t));return i}(n,D)};M="keys",T=function(){return function(n){return K(Object(P(n)))}},x=(y.Object||{})[M]||Object[M],(I={})[M]=T(x),d(d.S+d.F*i(function(){x(1)}),"Object",I);var $=y.Object.keys,J=n(e(function(n){n.exports={default:$,__esModule:!0}}));function X(n,e){var t=n.path,r=n.param,o=void 0!==r?J(r).map(function(n){return n+"="+r[n]}).join("&"):"";return e.protocol+"://"+t+"?"+o}function Z(n,e){var t=e.outChain,r=X(n,e);void 0!==t&&t&&(r=t.protocal+"://"+t.path+"?"+t.key+"="+encodeURIComponent(r));return r}var nn=null;function en(n){var e,t=document.createElement("a"),r=(e=void 0,window.CustomEvent?e=new window.CustomEvent("click",{canBubble:!0,cancelable:!0}):(e=document.createEvent("HTMLEvents")).initEvent("click",!1,!1),e);t.setAttribute("href",n),t.style.display="none",document.body.appendChild(t),t.dispatchEvent(r)}function tn(n){window.top.location.href=n}function rn(n){nn||((nn=document.createElement("iframe")).frameborder="0",nn.style.cssText="display:none;border:0;width:0;height:0;",document.body.appendChild(nn)),nn.src=n}return function(){function e(n){t(this,e),this.options=n||{}}return j(e,[{key:"generateScheme",value:function(n){return Z(n,this.options)}},{key:"generateIntent",value:function(n){return function(n,e){var t=n.outChain,r=e.intent,o=e.fallback,i=J(r).map(function(n){return n+"="+r[n]+";"}).join(""),u=X(n,e);if(void 0!==t&&!t){var a=n.outChain;return"intent://"+a.path+"?"+a.key+"="+encodeURIComponent(u)+"/\n      #Intent;"+i+";S.browser_fallback_url="+encodeURIComponent(o)+";end;"}return"intent://"+(u=u.slice(u.indexOf("//")+2))+"/#Intent;"+i+";end;"}(n,this.options)}},{key:"generateUniversalLink",value:function(n){return function(n,e){var t=e.universal;if(!t)return"";var r=t.host,o=t.pathKey,i=n.path,u=n.param,a=void 0!==u?J(u).map(function(n){return n+"="+u[n]}).join("&"):"";return"//"+r+"?"+o+"="+i+(a?"&":"")+a}(n,this.options)}},{key:"generateYingYongBao",value:function(n){return e=n,t=this.options,r=Z(e,t),t.yingyongbao+"&android_schema="+encodeURIComponent(r);var e,t,r}},{key:"checkOpen",value:function(n){setTimeout(function(){document.hidden||document.webkitHidden||n()},this.timeout)}},{key:"fallToAppStore",value:function(){var n=this;this.checkOpen(function(){tn(n.options.appstore)})}},{key:"fallToFbUrl",value:function(){var n=this;this.checkOpen(function(){tn(n.options.fallback)})}},{key:"fallToCustomCb",value:function(n){this.checkOpen(function(){n()})}},{key:"open",value:function(n){var e,t,r,o,i=(e=window.navigator.userAgent||"",t=/android/i.test(e),r=/iphone|ipad|ipod/i.test(e),{isAndroid:t,isIos:r,isWechat:/micromessenger\/([\d.]+)/i.test(e),isWeibo:/(weibo).*weibo__([\d.]+)/i.test(e),isQQ:/qq\/([\d.]+)/i.test(e),isQzone:/qzone\/.*_qz_([\d.]+)/i.test(e),isOriginalChrome:/chrome\/[\d.]+ Mobile Safari\/[\d.]+/i.test(e)&&t&&e.indexOf("Version")<0,isSafari:/safari\/([\d.]+)$/i.test(e)&&r&&e.indexOf("Crios")<0&&0===e.indexOf("Mozilla")}),u=this.options,a=u.universal,c=u.appstore,f=u.logFunc,s=n.callback,l=void 0!==a,p=this.generateScheme(n),d=this.generateIntent(n),h=this.generateUniversalLink(n),v=this.generateYingYongBao(n),y=null;void 0!==f&&f(),i.isIos?i.isWechat?tn(c):(o=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),parseInt(o[1],10)<9?(rn(p),y=this.fallToAppStore):l?tn(h):(tn(p),y=this.fallToAppStore)):i.isWechat?tn(v):i.isOriginalChrome?en(d):(rn(p),y=this.fallToFbUrl),void 0===s?y&&y.call(this):this.fallToCustomCb(s)}}]),e}()});
